<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>SUDOKU OR DIE - VOID EDITION</title>
    <style>
        :root { --blood: #660000; --active-blood: #ff0000; }
        * { -webkit-tap-highlight-color: transparent; box-sizing: border-box; }
        
        body { 
            background: #000; color: #888; 
            font-family: 'Courier New', monospace;
            margin: 0; overflow: hidden; height: 100vh;
            display: flex; flex-direction: column; align-items: center;
        }

        /* AMBIANCE VISUELLE */
        #noise-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: url('https://media.giphy.com/media/oEI9uWUPr9WUM/giphy.gif');
            opacity: 0.03; pointer-events: none; z-index: 10;
        }

        /* HEADER & DIALOGUES */
        #dialogue-container {
            width: 100%; height: 120px;
            display: flex; align-items: center; justify-content: center;
            padding: 20px; text-align: center;
            border-bottom: 1px solid #1a0000;
        }
        #monster-text {
            color: var(--active-blood);
            font-size: 1.1rem; font-weight: bold;
            text-transform: uppercase; letter-spacing: 1px;
            text-shadow: 0 0 8px var(--blood);
        }

        /* BARRE DE MENACE */
        .threat-wrap { width: 90%; height: 4px; background: #111; margin: 10px 0; border-radius: 2px; }
        #threat-fill { width: 0%; height: 100%; background: var(--blood); transition: width 0.5s linear; }

        /* GRILLE SUDOKU */
        #grid {
            display: grid; grid-template-columns: repeat(9, 1fr);
            width: 92vw; height: 92vw; max-width: 380px; max-height: 380px;
            background: #111; border: 2px solid #222;
        }
        .cell {
            background: #000; border: 0.5px solid #111;
            display: flex; align-items: center; justify-content: center;
            font-size: 1.4rem; font-weight: bold; color: #fff;
        }
        .cell.fixed { color: #444; background: #050505; }
        .cell.selected { background: #1a0000; box-shadow: inset 0 0 15px #ff000044; }
        .cell.err { color: var(--active-blood); animation: shake 0.2s; }

        /* CLAVIER */
        #numpad {
            display: grid; grid-template-columns: repeat(5, 1fr);
            gap: 10px; width: 90%; margin-top: 20px;
        }
        .key {
            background: #0a0a0a; border: 1px solid #222; color: #666;
            padding: 15px 0; border-radius: 5px; font-size: 1.2rem;
            text-align: center;
        }
        .key:active { background: var(--blood); color: #fff; }

        @keyframes shake { 0%, 100% {transform: translateX(0);} 25% {transform: translateX(-4px);} 75% {transform: translateX(4px);} }

        /* ECRAN START */
        #start-screen {
            position: fixed; inset: 0; background: #000; z-index: 100;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
        }
        #start-btn {
            background: none; border: 1px solid var(--blood); color: var(--blood);
            padding: 15px 40px; font-size: 1.2rem; cursor: pointer;
            letter-spacing: 5px;
        }
    </style>
</head>
<body>

    <div id="noise-overlay"></div>

    <div id="start-screen">
        <h1 style="color:var(--blood); letter-spacing:10px;">VOID</h1>
        <input type="text" id="user-name" placeholder="NOM DE L'ÂME" 
               style="background:none; border:none; border-bottom:1px solid #333; color:#fff; text-align:center; margin:20px; outline:none;">
        <button id="start-btn" onclick="initGame()">ENTRER DANS L'OBSCURITÉ</button>
    </div>

    <div id="dialogue-container">
        <div id="monster-text">... ÉCOUTE MA RESPIRATION ...</div>
    </div>

    <div class="threat-wrap"><div id="threat-fill"></div></div>

    <div id="grid"></div>

    <div id="numpad">
        <div class="key" onclick="press(1)">1</div>
        <div class="key" onclick="press(2)">2</div>
        <div class="key" onclick="press(3)">3</div>
        <div class="key" onclick="press(4)">4</div>
        <div class="key" onclick="press(5)">5</div>
        <div class="key" onclick="press(6)">6</div>
        <div class="key" onclick="press(7)">7</div>
        <div class="key" onclick="press(8)">8</div>
        <div class="key" onclick="press(9)">9</div>
        <div class="key" style="background:#1a0000" onclick="press(0)">X</div>
    </div>

    <script>
        let selected = null;
        let threat = 0;
        let playerName = "Mortel";
        let solution = "534678912672195348198342567859761423426853791713924856961537284287419635345286179".split('');
        
        // --- 100 DIALOGUES ---
        const dialogues = [
            "Je sens ton souffle sur l'écran, [NOM].", "Chaque seconde ici est une année dans mon monde.", 
            "Pourquoi tes doigts tremblent-ils ?", "Le Sudoku n'est qu'un prétexte pour te garder ici.",
            "J'aime quand tu réfléchis... ton cerveau devient si chaud.", "Regarde derrière toi. Non, je rigole.",
            "Tu penses que tu vas sortir d'ici ?", "[NOM], ton rythme cardiaque s'accélère.",
            "Fais une erreur. Juste une. Pour moi.", "Le vide te regarde aussi.",
            "Tes yeux fatiguent, n'est-ce pas ?", "Je suis dans les pixels.", "Bientôt, tu ne feras qu'un avec la grille.",
            "Est-ce que quelqu'un sait que tu joues à ça ?", "J'entends ta respiration.", "Concentrate-toi... ou meurt.",
            "Chaque chiffre posé est un pas vers ta fin.", "Tu es si lent, [NOM].", "Ma faim est insatiable.",
            "N'oublie pas de respirer. Moi, je n'en ai pas besoin.", "Tes erreurs ont un goût de fer.",
            "Le noir autour de la grille... c'est moi.", "Tu es au niveau 1, et tu as déjà peur ?",
            "Ne ferme pas les yeux.", "Ta solitude est délicieuse.", "Je ne suis pas seul dans cette pièce.",
            "L'obscurité te va si bien.", "[NOM]... [NOM]... [NOM]...", "Encore un chiffre, petit insecte.",
            "Tu joues ta vie sur un 9 ?", "Ma patience a des limites.", "Touche encore cette case... pour voir.",
            "Ton âme est plus complexe que cette grille.", "Le silence est lourd, n'est-ce pas ?",
            "Je te vois à travers la caméra. Mentir est inutile.", "Même si tu gagnes, je reste là.",
            "Tic. Tac. Tic. Tac.", "Ton sang circule si vite.", "Je n'ai pas de visage, mais je te souris.",
            "Veux-tu que je t'aide ? Non.", "Cette case est fausse. Ou peut-être pas.",
            "Tu as oublié de fermer la porte.", "Il y a quelque chose sous ton lit maintenant.",
            "Regarde tes mains. Elles appartiennent au vide.", "Ne me fais pas attendre, [NOM].",
            "Ton nom sera gravé sur cette cellule.", "Tu es prisonnier des chiffres.",
            "Même la lumière ne peut t'aider ici.", "Je suis ton ombre.", "L'enfer est un Sudoku sans fin.",
            "Arrête de cligner des yeux.", "Tu es si fragile.", "Je peux sentir ta peur monter.",
            "Un mauvais mouvement et tout s'arrête.", "Est-ce que tu m'entends vraiment ?",
            "Je suis le murmure dans tes oreilles.", "Pourquoi tu ne pars pas ?", "Parce que tu ne peux pas.",
            "Tu es à moi.", "Le vide appelle le vide.", "Tes pensées sont si bruyantes.",
            "Le 5 ? Vraiment ?", "Ta logique est pitoyable.", "Même un enfant ferait mieux.",
            "Je vais te briser.", "Pas de sortie. Pas d'issue.", "Abandonne.", "Laisse-moi entrer.",
            "Ton écran est une prison.", "Je caresse ton esprit.", "Tu as froid ?", "La température baisse, n'est-ce pas ?",
            "Tu es le prochain.", "Rien ne peut te sauver.", "Pas même la victoire.", "Je suis déjà derrière toi.",
            "Ton nom résonne dans l'abysse.", "Tu n'es qu'une suite de chiffres.", "La grille se nourrit de toi.",
            "Ton agonie est ma musique.", "Chante pour moi, [NOM].", "Pose ce 7. Je t'attends.",
            "La fin est proche.", "Le 0 n'existe pas ici.", "Comme ton avenir.", "Je ris de ta confusion.",
            "Tu es perdu ?", "Laisse-toi aller.", "Le noir est si paisible.", "Ne lutte plus.",
            "L'oxygène devient rare.", "Ton temps est écoulé.", "Je te tiens.", "À jamais.",
            "Dernière chance.", "Adieu, [NOM].", "Nous y sommes enfin.", "Bienvenue chez moi."
        ];

        // --- AUDIO ---
        const breathAudio = new Audio('https://www.soundjay.com/human/sounds/human-breath-1.mp3'); // Simulation
        breathAudio.loop = true;

        function initGame() {
            playerName = document.getElementById('user-name').value || "Mortel";
            document.getElementById('start-screen').style.display = 'none';
            breathAudio.play();
            
            const grid = document.getElementById('grid');
            for(let i=0; i<81; i++) {
                let cell = document.createElement('div');
                cell.className = 'cell';
                cell.id = 'c' + i;
                if(Math.random() > 0.4) {
                    cell.innerText = solution[i];
                    cell.classList.add('fixed');
                }
                cell.onclick = () => {
                    if(!cell.classList.contains('fixed')) {
                        if(selected) selected.classList.remove('selected');
                        selected = cell;
                        selected.classList.add('selected');
                    }
                };
                grid.appendChild(cell);
            }
            
            setInterval(gameLoop, 1000);
        }

        function gameLoop() {
            threat += 0.4;
            document.getElementById('threat-fill').style.width = threat + '%';
            
            // Accélération de la respiration
            breathAudio.playbackRate = 1 + (threat / 50);

            // Dialogue aléatoire
            if(Math.random() > 0.85) {
                let line = dialogues[Math.floor(Math.random()*dialogues.length)];
                let text = line.replace('[NOM]', playerName);
                document.getElementById('monster-text').innerText = text;
                speak(text);
            }

            if(threat >= 100) {
                document.body.innerHTML = "<h1 style='color:red; text-align:center; margin-top:45vh;'>ÂME CONSUMÉE</h1>";
                speak("Ton temps est fini. Je te prends.");
                setTimeout(() => location.reload(), 3000);
            }
        }

        function press(n) {
            if(!selected) return;
            let idx = selected.id.substring(1);
            if(n === 0) {
                selected.innerText = "";
            } else {
                selected.innerText = n;
                if(n != solution[idx]) {
                    selected.classList.add('err');
                    threat += 5;
                    speak("Erreur fatale.");
                    setTimeout(() => selected.classList.remove('err'), 300);
                } else {
                    selected.style.color = "#00ff00";
                    checkWin();
                }
            }
        }

        function speak(t) {
            window.speechSynthesis.cancel();
            let m = new SpeechSynthesisUtterance(t);
            m.lang = 'fr-FR'; m.pitch = 0.1; m.rate = 0.7;
            window.speechSynthesis.speak(m);
        }

        function checkWin() {
            let win = true;
            for(let i=0; i<81; i++) {
                if(document.getElementById('c'+i).innerText != solution[i]) win = false;
            }
            if(win) {
                document.body.innerHTML = "<h1 style='color:white; text-align:center; margin-top:45vh;'>ÉCHAPPÉ... POUR L'INSTANT</h1>";
            }
        }
    </script>
</body>
</html>
