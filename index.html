<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>PLURIBUS : REBORN</title>
    <style>
        /* Design "Noir & Violet" pour mobile */
        :root {
            --bg-color: #0d0d0d;
            --text-color: #e0e0e0;
            --accent-color: #8a2be2; /* Violet Signal Ma√Ætre */
            --danger-color: #ff4d4d;
        }

        body {
            background-color: var(--bg-color);
            color: var(--text-color);
            font-family: 'Courier New', Courier, monospace; /* Style r√©tro */
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            height: 100vh;
            overflow: hidden;
        }

        /* Barre de Synchro en haut */
        #stat-bar {
            padding: 10px;
            background: #1a1a1a;
            border-bottom: 2px solid var(--accent-color);
            font-size: 12px;
            display: flex;
            justify-content: space-between;
        }

        #sync-fill {
            height: 5px;
            background: var(--accent-color);
            width: 0%; /* √âvolue en fonction du jeu */
            transition: width 0.5s;
            box-shadow: 0 0 10px var(--accent-color);
        }

        /* Zone d'affichage de l'histoire */
        #game-container {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
        }

        .pixel-art-scene {
            text-align: center;
            font-size: 50px; /* Utilisation d'emojis comme sprites pixel */
            margin-bottom: 20px;
            filter: grayscale(0.5);
        }

        .story-text {
            line-height: 1.5;
            margin-bottom: 20px;
            font-size: 16px;
            animation: fadeIn 1s;
        }

        /* Boutons de choix (Style Telltale) */
        .choices-container {
            display: flex;
            flex-direction: column;
            gap: 10px;
            padding: 20px;
        }

        .choice-btn {
            background: transparent;
            border: 1px solid var(--accent-color);
            color: var(--text-color);
            padding: 15px;
            text-align: left;
            font-family: inherit;
            font-size: 14px;
            cursor: pointer;
            transition: 0.3s;
        }

        .choice-btn:active {
            background: var(--accent-color);
            color: white;
        }

        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    </style>
</head>
<body>

    <div id="stat-bar">
        <span>NOM : <span id="player-name">...</span></span>
        <span>SYNCHRO : <span id="sync-val">0%</span></span>
    </div>
    <div id="sync-fill"></div>

    <div id="game-container">
        <div id="scene" class="pixel-art-scene">üèôÔ∏è</div>
        <div id="text" class="story-text">
            Chargement de la conscience...
        </div>
    </div>

    <div id="choices" class="choices-container">
        </div>

    <script>
        // La logique Javascript viendra √† l'√âtape 2
    </script>
</body>
</html>
const story = {
    start: {
        text: "Bruxelles. Rue Neuve. Tu te r√©veilles au sol. Ton cr√¢ne bourdonne. Le 'Lien' a √©t√© bris√© par une onde de choc massive. Tu vomis un liquide noir... ton corps rejette la ruche.",
        scene: "üè¢",
        choices: [
            { text: "Se lever avec peine et chercher son nom", next: "naming" }
        ]
    },
    naming: {
        text: "Tu regardes un vieux pass Navigo au sol. Qui es-tu ?",
        scene: "üí≥",
        type: "input",
        next: "awakening"
    },
    awakening: {
        text: "Marc, ton voisin, est sur le pas de la porte. Ses yeux sont vides, calmes. Il te tend une tasse de prot√©ines (HDP). 'Tu as faim, nous le sentons. Reviens dans le Lien.'",
        scene: "üë§",
        choices: [
            { text: "Accepter la tasse (Rester connect√©)", next: "stay_connected", sync: 15 },
            { text: "Renverser la tasse (Refuser)", next: "rebel", sync: -5 },
            { text: "Frapper Marc et fuir", next: "violence", sync: 0 }
        ]
    },
    stay_connected: {
        text: "Le liquide est ti√®de. Aussit√¥t, les murmures de la ruche reviennent. Tu sais que Diabat√© surveille la ville. Tu te sens en s√©curit√©, mais ton 'Moi' s'efface.",
        scene: "üß¨",
        choices: [
            { text: "Prendre la radio de Marc et partir", next: "escape_brussels" }
        ]
    },
    rebel: {
        text: "La tasse se brise. Marc penche la t√™te, triste. 'La solitude est une maladie, [NOM]'. Tu sens une force incroyable : tu es libre, mais seul.",
        scene: "üíî",
        choices: [
            { text: "Prendre l'√©chelle de secours", next: "escape_brussels" }
        ]
    },
    violence: {
        text: "Tu le pousses violemment. Il ne r√©plique pas, les Pluribus ne connaissent pas la haine. Tu d√©vales les escaliers.",
        scene: "üèÉ",
        choices: [
            { text: "Sortir dans la rue", next: "escape_brussels" }
        ]
    },
    escape_brussels: {
        text: "Dehors, le ciel vire au violet. Un drone de Diabat√© survole la zone. 'Alerte : Dissident d√©tect√©'. Le voyage vers Carol commence.",
        scene: "üöÅ",
        choices: [
            { text: "Chercher un v√©hicule", next: "end_prologue" }
        ]
    },
    end_prologue: {
        text: "FIN DU PROLOGUE. Tu as surv√©cu √† Bruxelles. Prochain arr√™t : La fronti√®re fran√ßaise.",
        scene: "üõ£Ô∏è",
        choices: [
            { text: "Rejouer", next: "start" }
        ]
    }
};

let currentSync = 0;
let playerName = "";

function updateGame(stepKey) {
    const step = story[stepKey];
    const textElement = document.getElementById('text');
    const choicesElement = document.getElementById('choices');
    const sceneElement = document.getElementById('scene');

    // Mise √† jour visuelle
    sceneElement.innerText = step.scene;
    textElement.innerHTML = step.text.replace("[NOM]", playerName);

    // Gestion du Naming
    if (step.type === "input") {
        const name = prompt("Entre ton Pr√©nom :");
        playerName = name || "Inconnu";
        document.getElementById('player-name').innerText = playerName;
        updateGame(step.next);
        return;
    }

    // Nettoyage des choix
    choicesElement.innerHTML = "";

    // Cr√©ation des boutons de choix
    step.choices.forEach(choice => {
        const btn = document.createElement('button');
        btn.classList.add('choice-btn');
        btn.innerText = choice.text;
        btn.onclick = () => {
            if (choice.sync) {
                currentSync = Math.max(0, Math.min(100, currentSync + choice.sync));
                document.getElementById('sync-val').innerText = currentSync + "%";
                document.getElementById('sync-fill').style.width = currentSync + "%";
            }
            updateGame(choice.next);
        };
        choicesElement.appendChild(btn);
    });
}

// Lancement du jeu
updateGame('start');
/* Effet de secousse (Glitch) */
@keyframes shake {
    0% { transform: translate(0,0); }
    10% { transform: translate(-5px, -2px); filter: hue-rotate(90deg); }
    20% { transform: translate(5px, 2px); }
    30% { transform: translate(-5px, 0px); filter: invert(1); }
    40% { transform: translate(0, 2px); }
    100% { transform: translate(0,0); }
}

.glitch-active {
    animation: shake 0.3s infinite;
    border: 2px solid var(--danger-color) !important;
}

/* Overlay pour le Signal Ma√Ætre (Violet) */
#signal-overlay {
    position: fixed;
    top: 0; left: 0; width: 100%; height: 100%;
    background: rgba(138, 43, 226, 0.1);
    pointer-events: none; /* Ne bloque pas les clics */
    opacity: 0;
    transition: opacity 2s;
    z-index: 100;
}

/* Texte qui clignote quand la synchro est haute */
.sync-warning {
    color: var(--accent-color);
    text-shadow: 0 0 5px var(--accent-color);
    font-weight: bold;
}
// Ajoute cet √©l√©ment au d√©but de ton body via JS ou HTML
const overlay = document.createElement('div');
overlay.id = 'signal-overlay';
document.body.appendChild(overlay);

function triggerGlitch(duration) {
    const container = document.getElementById('game-container');
    container.classList.add('glitch-active');
    
    // Son hypoth√©tique (vibration mobile)
    if (navigator.vibrate) navigator.vibrate([50, 30, 50]);

    setTimeout(() => {
        container.classList.remove('glitch-active');
    }, duration);
}

// Modifie la logique de mise √† jour du jeu
function updateGame(stepKey) {
    const step = story[stepKey];
    const textElement = document.getElementById('text');
    const choicesElement = document.getElementById('choices');
    const sceneElement = document.getElementById('scene');

    // Effet visuel selon la Synchro
    if (currentSync > 50) {
        document.getElementById('signal-overlay').style.opacity = "0.5";
        if (Math.random() > 0.7) triggerGlitch(500); // Glitch al√©atoire si synchro haute
    }

    // Animation de texte "Machine √† √©crire"
    textElement.innerHTML = "";
    let i = 0;
    let fullText = step.text.replace("[NOM]", playerName);
    
    function typeWriter() {
        if (i < fullText.length) {
            textElement.innerHTML += fullText.charAt(i);
            i++;
            setTimeout(typeWriter, 20); // Vitesse d'√©criture
        }
    }
    typeWriter();

    sceneElement.innerText = step.scene;
    choicesElement.innerHTML = "";

    step.choices.forEach(choice => {
        const btn = document.createElement('button');
        btn.classList.add('choice-btn');
        btn.innerText = choice.text;
        btn.onclick = () => {
            // Si le choix est risqu√©, on d√©clenche un glitch
            if (choice.sync && choice.sync > 10) triggerGlitch(400);
            
            if (choice.sync) {
                currentSync = Math.max(0, Math.min(100, currentSync + choice.sync));
                document.getElementById('sync-val').innerText = currentSync + "%";
                document.getElementById('sync-fill').style.width = currentSync + "%";
            }
            updateGame(choice.next);
        };
        choicesElement.appendChild(btn);
    });
}
const story = {
    // ... (pr√©c√©dentes √©tapes du prologue et escape_brussels) ...

    escape_brussels: {
        text: "Dehors, le ciel vire au violet. Un drone de Diabat√© survole la zone. 'Alerte : Dissident d√©tect√©'. Le voyage vers Carol commence.",
        scene: "üöÅ",
        choices: [
            { text: "Chercher un v√©hicule", next: "car_theft" }
        ]
    },
    car_theft: {
        text: "Une voiture √©lectrique des Autres. Tu n'as pas besoin de cl√©s. En posant ta main sur le tableau de bord, tes r√©sidus de connexion 'parlent' au v√©hicule. Moteur d√©marr√©.",
        scene: "üöó",
        sync: 5, // petite augmentation de synchro pour l'utilisation de savoir Pluribus
        choices: [
            { text: "Rouler vers le sud", next: "pursuit_laxmi" }
        ]
    },
    pursuit_laxmi: {
        text: "L'√©cran de bord s'allume. Laxmi. 'Arr√™te-toi, [NOM]. Le monde se d√©chire. Si tu franchis la porte d'Anderlecht, nous te consid√©rerons une menace pour l'√©quilibre.' Deux voitures Sentinelles surgissent.",
        scene: "üöìüöì",
        choices: [
            { text: "Percuter une Sentinelle (Voie Manousos)", next: "collide_sentinel", sync: -10 }, // Humanit√© augmente (moins de lien)
            { text: "Surcharger leurs syst√®mes (Voie Carol)", next: "overload_sentinels", sync: 15 }, // Plus de synchro
            { text: "Tenter de n√©gocier avec Laxmi", next: "negotiate_laxmi", sync: 0 }
        ]
    },
    collide_sentinel: {
        text: "Un choc violent ! La voiture Sentinelle est hors d'usage. Des Pluribus instrumentalis√©s sont bless√©s. Laxmi √©met un cri num√©rique de tristesse. Tu as gagn√© du temps. La route est libre, mais √† quel prix...",
        scene: "üí•",
        choices: [
            { text: "Continuer vers la fronti√®re", next: "border_encounter" }
        ]
    },
    overload_sentinels: {
        text: "Tes doigts s'illuminent. Les voitures Sentinelles s'arr√™tent, leurs syst√®mes grill√©s. Mais le choc en retour d√©truit la radio de ta voiture. Tu es libre, mais sourd aux communications de la Ruche.",
        scene: "‚ö°",
        choices: [
            { text: "Continuer vers la fronti√®re", next: "border_encounter" }
        ]
    },
    negotiate_laxmi: {
        text: "Laxmi h√©site. 'Tu es un manipulateur, [NOM] !' Les voitures ralentissent un instant, te laissant une ouverture. Elle est d√©sormais ton antagoniste majeure.",
        scene: "üò†",
        choices: [
            { text: "Foncer vers la fronti√®re", next: "border_encounter" }
        ]
    },

    // --- DEBUT CHAPITRE 2 : LA TERRE DE PERSONNE ---
    border_encounter: {
        text: "Ta voiture s'arr√™te, batterie √† plat. Tu es seul, au milieu de voitures abandonn√©es. Le ciel est violet. Un drone de la Fondation Diabat√© approche...",
        scene: "üõ£Ô∏è",
        choices: [
            { text: "Se cacher derri√®re un camion", next: "xiu_mei_intro" }
        ]
    },
    xiu_mei_intro: {
        text: "Une main gant√©e te tire √† l'abri. C'est une femme au regard d'acier. 'T'as les yeux qui brillent, gamin. T'es un de ceux qui reviennent de l'Enfer, pas vrai ? Je suis Xiu Mei.'",
        scene: "üë©‚Äçü¶≥", // Emoji pour Xiu Mei
        choices: [
            { text: "√âcouter Xiu Mei", next: "xiu_mei_dialogue" }
        ]
    },
    xiu_mei_dialogue: {
        text: "Xiu Mei : 'Carol veut tout br√ªler. Diabat√© veut tout contr√¥ler. Et toi, le 13√®me Bug, tu veux quoi ? Si je te donne ce fusil, tu tires sur qui ?'",
        scene: "üî´", // Fusil
        choices: [
            { text: "Pro-Carol : 'Je veux que ce silence dans ma t√™te s'arr√™te. D√©truisons le signal.'", next: "xiu_mei_ally", sync: -10 },
            { text: "Pro-Laxmi : 'Il faut les lib√©rer, pas les tuer.'", next: "xiu_mei_suspicion", sync: 10 },
            { text: "Ind√©pendant : 'Je veux juste survivre jusqu'en Espagne. Donnez-moi ce fusil et laissez-moi passer.'", next: "xiu_mei_neutral", sync: 0 }
        ]
    },
    xiu_mei_ally: {
        text: "Xiu Mei sourit. 'Bien. Suis-moi. Nous avons un relais satellite √† d√©truire pr√®s de Lille. √áa va rendre Diabat√© fou.'",
        scene: "ü§ù",
        choices: [
            { text: "Se pr√©parer au combat", next: "ambush_diabate" }
        ]
    },
    xiu_mei_suspicion: {
        text: "Xiu Mei se crispe. 'Tu as √©t√© l'un d'eux. Tu es dangereux. Je te surveille.' Elle t'entra√Æne avec elle, m√©fiante. 'Diabat√© nous a rep√©r√©s.'",
        scene: "ü§®",
        choices: [
            { text: "Se pr√©parer au combat", next: "ambush_diabate" }
        ]
    },
    xiu_mei_neutral: {
        text: "Xiu Mei te jette un fusil. 'Soit. Juste, ne te mets pas sur mon chemin.' Des Pluribus sortent des bois. Des Sentinelles ouvrent le feu.",
        scene: "üå≤",
        choices: [
            { text: "Se pr√©parer au combat", next: "ambush_diabate" }
        ]
    },
    ambush_diabate: {
        text: "La radio de Xiu Mei gr√©sille. 'Xiu Mei, je sais que tu es avec le nouveau. Ne compliquez pas les choses. Les Autres ont besoin de ce relais pour rester stables.' Des Pluribus arm√©s avancent. C'est l'embuscade !",
        scene: "üö®",
        choices: [
            { text: "Utiliser Savoir de Ruche pour enrayer les armes (Risqu√©)", next: "sabotage_sentinels", sync: 20 },
            { text: "Couvrir Xiu Mei avec le fusil (Risque de blessure)", next: "fight_sentinels", sync: -5 },
            { text: "N√©gocier avec Diabat√© via le drone (Difficile)", next: "negotiate_diabate", sync: 0 }
        ]
    },
    sabotage_sentinels: {
        text: "Tes yeux br√ªlent, mais les fusils des Sentinelles s'enrayent ! 'Impossible !' crie Diabat√© via le drone. Vous avez une ouverture !",
        scene: "üëÅÔ∏è‚Äçüó®Ô∏è",
        choices: [
            { text: "Fuite vers Lille avec Xiu Mei", next: "end_chapter2" }
        ]
    },
    fight_sentinels: {
        text: "Tu tires. Un Sentinelle tombe. Xiu Mei te couvre. Mais tu es touch√© au bras ! La douleur est vive. Vous devez fuir.",
        scene: "ü©π",
        choices: [
            { text: "Fuite vers Lille avec Xiu Mei", next: "end_chapter2" }
        ]
    },
    negotiate_diabate: {
        text: "Diabat√© reste impassible. 'Ton discours est inutile. L'heure n'est plus aux mots.' Les Sentinelles avancent. Xiu Mei crie : 'On doit fuir !'",
        scene: "üó£Ô∏è",
        choices: [
            { text: "Fuite vers Lille avec Xiu Mei", next: "end_chapter2" }
        ]
    },
    end_chapter2: {
        text: "FIN DU CHAPITRE 2. Tu as rencontr√© ton premier alli√©. Le v√©ritable combat ne fait que commencer. Prochain arr√™t : Lyon.",
        scene: "‚õ∞Ô∏è",
        choices: [
            { text: "Continuer", next: "start" } // Pour le test, on boucle au d√©but
        ]
    }
    // ... (pr√©c√©dentes √©tapes du prologue et escape_brussels) ...
};
const chapter3 = {
    end_chapter2: {
        text: "FIN DU CHAPITRE 2. Tu as pass√© la fronti√®re. Prochain arr√™t : Lyon, la ville des √©chos.",
        scene: "ü¶Å",
        choices: [
            { text: "Entrer dans Lyon avec Xiu Mei", next: "lyon_intro" }
        ]
    },
    lyon_intro: {
        text: "Lyon est plong√©e dans une brume violette. Le Signal Ma√Ætre est si fort que les lampadaires clignotent au rythme d'un c≈ìur. Tu entends des g√©missements...",
        scene: "üèôÔ∏è",
        choices: [
            { text: "Suivre les bruits vers le centre commercial", next: "lyon_horror" }
        ]
    },
    lyon_horror: {
        text: "Vision d'horreur. 50 Pluribus rampent au sol, hurlant de terreur. Le brouilleur de Carol les a d√©connect√©s, mais ils ne savent plus qui ils sont. Ils meurent de solitude mentale.",
        scene: "üò±",
        choices: [
            { text: "S'approcher des survivants", next: "lyon_dilemma" }
        ]
    },
    lyon_dilemma: {
        text: "Des Sentinelles de Laxmi arrivent avec du 'S√©rum de Stabilit√©' pour les reconnecter de force. Xiu Mei te tend un explosif : 'Si tu d√©truis le s√©rum, ils restent libres... mais ils souffriront.'",
        scene: "üß™",
        choices: [
            { text: "D√©truire le s√©rum (Libert√© atroce)", next: "lyon_destroy", sync: -20 },
            { text: "Laisser faire (Paix forc√©e)", next: "lyon_save", sync: 20 },
            { text: "Tenter de modifier le s√©rum (Savoir 13√®me)", next: "lyon_hack", sync: 30 }
        ]
    },
    lyon_destroy: {
        text: "BOUM. Le s√©rum est d√©truit. Les Sentinelles fuient. Les Pluribus hurlent de plus belle, perdus dans le noir de leur propre esprit. Xiu Mei hoche la t√™te : 'Le prix de la libert√©.'",
        scene: "üî•",
        choices: [
            { text: "Fuir avant l'arriv√©e des drones", next: "lyon_roof_chase" }
        ]
    },
    lyon_save: {
        text: "Tu retiens Xiu Mei. Les Sentinelles injectent le s√©rum. Instantan√©ment, le silence revient. Les gens se l√®vent, calmes, les yeux vides. Ils sont redevenus des esclaves.",
        scene: "ü§´",
        choices: [
            { text: "Fuir avant l'arriv√©e des drones", next: "lyon_roof_chase" }
        ]
    },
    lyon_hack: {
        text: "Tes doigts manipulent les fioles. Tu injectes un code de stabilisation. Ils s'apaisent, mais restent des coquilles vides. Ni ruche, ni humains. Juste... rien.",
        scene: "üíæ",
        choices: [
            { text: "Fuir avant l'arriv√©e des drones", next: "lyon_roof_chase" }
        ]
    },
    lyon_roof_chase: {
        text: "Diabat√© d√©ploie ses drones de combat. 'C'est fini, [NOM] !' Tu cours sur les toits de Fourvi√®re. Soudain, une voix gr√©sille dans ton cr√¢ne... ce n'est pas Diabat√©.",
        scene: "üèÉ",
        choices: [
            { text: "√âcouter la voix", next: "zosia_message" }
        ]
    },
    zosia_message: {
        text: "C'est Zosia. Elle pleure. '[NOM]... Ne viens pas au Sud. Carol a chang√©. Elle a accept√© l'invitation des aliens. Elle ne nous sauve pas... elle nous traduit !'",
        scene: "üìª",
        choices: [
            { text: "Atteindre les Pyr√©n√©es", next: "end_chapter3" }
        ]
    },
    end_chapter3: {
        text: "FIN DU CHAPITRE 3. Le monde devient blanc. Zosia t'a pr√©venu. Mais tu n'as plus le choix.",
        scene: "üèîÔ∏è",
        choices: [
            { text: "Continuer vers le Mur", next: "start" } 
        ]
    }
};

// Fusionner avec l'objet story principal
Object.assign(story, chapter3);
const chapter4 = {
    end_chapter3: {
        text: "FIN DU CHAPITRE 3. Lyon est derri√®re toi. Devant : les Pyr√©n√©es. Un mur invisible de fr√©quences bloque l'Espagne.",
        scene: "üèîÔ∏è",
        choices: [
            { text: "Tenter l'ascension avec Xiu Mei", next: "pyrenees_climb" }
        ]
    },
    pyrenees_climb: {
        text: "L'air vibre. La neige tombe... mais elle ne fond pas, elle reste suspendue. Les tours de Diabat√© √©mettent un mur de douleur pour quiconque a d√©j√† √©t√© connect√©.",
        scene: "‚ùÑÔ∏è",
        choices: [
            { text: "Avancer malgr√© la souffrance", next: "pyrenees_ambush" }
        ]
    },
    pyrenees_ambush: {
        text: "Des drones surgissent du blizzard. Une projection g√©ante de Diabat√© appara√Æt : '[NOM], arr√™te. La fr√©quence de Carol va faire bouillir ton cerveau. Viens au Sanctuaire de Malaga.'",
        scene: "üìΩÔ∏è",
        choices: [
            { text: "Ignorer et avancer", next: "xiu_mei_fall" }
        ]
    },
    xiu_mei_fall: {
        text: "Une d√©charge paralyse Xiu Mei. Elle glisse vers le pr√©cipice et ne se tient plus que d'une main ! Diabat√© : 'Laisse-la. Elle est perdue. Choisis la paix.'",
        scene: "üßó‚Äç‚ôÄÔ∏è",
        choices: [
            { text: "Se livrer pour sauver Xiu Mei", next: "surrender_save", sync: 0 },
            { text: "La laisser et foncer vers la fronti√®re", next: "abandon_xiu", sync: -30 },
            { text: "Pirater les drones (Surcharge c√©r√©brale)", next: "overload_climb", sync: 40 }
        ]
    },
    surrender_save: {
        text: "Tu l√®ves les mains. Les Sentinelles capturent Xiu Mei pour la soigner. Tu es emmen√© vers Malaga dans une cage de verre. Tu as sauv√© une vie, mais tu es prisonnier.",
        scene: "üöî",
        choices: [
            { text: "S'√©vader et atteindre Gibraltar", next: "end_chapter4" }
        ]
    },
    abandon_xiu: {
        text: "Tu franchis la ligne de r√©sonance. Le cri de Xiu Mei se perd dans le vent. Tu es seul. Manousos t'attend au loin, mais ton √¢me est plus lourde que jamais.",
        scene: "üö∂‚Äç‚ôÇÔ∏è",
        choices: [
            { text: "Marcher vers le camp de Carol", next: "end_chapter4" }
        ]
    },
    overload_climb: {
        text: "Tu cries. Ton esprit force le r√©seau. Les drones explosent. Tu sauves Xiu Mei, mais tes yeux saignent. Le monde devient d√©finitivement VIOLET. Tu entends la Voix Alien.",
        scene: "üëÅÔ∏è‚Äçüó®Ô∏è",
        choices: [
            { text: "Marcher vers le camp de Carol", next: "end_chapter4" }
        ]
    },
    end_chapter4: {
        text: "FIN DU CHAPITRE 4. L'air sent l'ozone. Le Signal Ma√Ætre descend du ciel. Tu es aux portes de Gibraltar. Le final approche.",
        scene: "üè∞",
        choices: [
            { text: "Entrer dans la forteresse", next: "final_chapter" }
        ]
    }
};

Object.assign(story, chapter4);
const finalChapter = {
    final_chapter: {
        text: "Gibraltar. Le Rocher tremble. Le ciel est devenu d'un blanc aveuglant. Tu entres dans le bunker. Manousos est l√†, arm√©, devant Carol connect√©e √† des c√¢bles.",
        scene: "üåã",
        choices: [
            { text: "S'approcher de Carol", next: "carol_encounter" }
        ]
    },
    carol_encounter: {
        text: "Carol se tourne vers toi. Ses yeux projettent des flux de donn√©es. Elle parle avec mille voix : '[NOM]. Tu es le 13√®me Bug. Dois-je sauver ce monde bris√© ou le r√©√©crire ?'",
        scene: "üëÅÔ∏è",
        choices: [
            { text: "Soutenir Manousos (D√©truire la Ruche)", next: "ending_manousos" },
            { text: "Laisser Carol agir (Transcendance Alien)", next: "ending_carol" },
            { text: "Se sacrifier (Le Pare-feu Humain)", next: "ending_sacrifice" }
        ]
    },
    ending_manousos: {
        text: "Tu tires sur Carol. Le lien est rompu. La Ruche s'effondre dans un cri mondial. Des milliards de Pluribus meurent. La libert√© est l√†, mais le monde est un cimeti√®re. Tu es libre... et terriblement seul.",
        scene: "üíÄ",
        choices: [
            { text: "FIN : LA LIBERT√â DES CENDRES", next: "start" }
        ]
    },
    ending_carol: {
        text: "Tu √©cartes Manousos. Carol active le Signal Ma√Ætre. Une onde blanche recouvre la Terre. La douleur s'arr√™te. L'humanit√© devient une pure donn√©e extraterrestre. Tu n'es plus [NOM]. Tu es l'infini.",
        scene: "‚ú®",
        choices: [
            { text: "FIN : LA TRANSCENDANCE BLANCHE", next: "start" }
        ]
    },
    ending_sacrifice: {
        text: "Tu te connectes √† sa place. Ton exp√©rience de Bruxelles, tes doutes, ton humanit√©... tu injectes tout dans le Signal. La Ruche se fragmente. Les gens se r√©veillent, connect√©s mais LIBRES. Tu meurs, mais le monde est sauv√©.",
        scene: "üß†",
        choices: [
            { text: "FIN : LE SACRIFICE DE L'√âVEILL√â", next: "start" }
        ]
    }
};

Object.assign(story, finalChapter);
// √Ä mettre dans la fonction onclick des choix finaux
if (navigator.vibrate) navigator.vibrate([1000, 500, 2000]);
